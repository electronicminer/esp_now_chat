

```markdown
# ğŸ“¡ ESP32 ESP-NOWåŒå‘é€šä¿¡ä¸Webå®æ—¶æ¶ˆæ¯ç³»ç»Ÿ

![Project Banner](https://img-blog.csdnimg.cn/direct/4c46b8d4a1a94f0d9c3d1a5a5d8e4e9a.png)  
*é€šè¿‡ESP-NOWåè®®å®ç°è®¾å¤‡é—´å¯é é€šä¿¡ï¼Œç»“åˆWebSocketæä¾›å®æ—¶ç½‘é¡µäº¤äº’*

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½
- **åŒé‡é€šä¿¡åè®®**  
  `ESP-NOW`ç›´è¿ä¼ è¾“ + `WebSocket`å®æ—¶æ¨é€
- **æ¶ˆæ¯å¯é æ€§**  
  âœ”ï¸ æ¶ˆæ¯IDæ ‡è®° âœ”ï¸ ACKç¡®è®¤æœºåˆ¶ âœ”ï¸ 2ç§’è¶…æ—¶é‡ä¼ 
- **å¯è§†åŒ–ç›‘æ§**  
  Webç•Œé¢å®æ—¶æ˜¾ç¤ºï¼š`å‘é€ä¸­` â†’ `âˆšæˆåŠŸ` / `Ã—å¤±è´¥`
- **å³æ’å³ç”¨**  
  ğŸ“¶ è‡ªåŠ¨åˆ›å»ºWiFiçƒ­ç‚¹ï¼Œæ‰‹æœº/ç”µè„‘ç›´æ¥è®¿é—®

## ğŸ“š ç›®å½•
- [ç¡¬ä»¶è¦æ±‚](#-ç¡¬ä»¶è¦æ±‚)
- [å¿«é€Ÿéƒ¨ç½²](#-å¿«é€Ÿéƒ¨ç½²)
- [ç³»ç»Ÿæ¶æ„](#-ç³»ç»Ÿæ¶æ„)  
- [ä»£ç ç»“æ„](#-ä»£ç ç»“æ„)
- [è¿›é˜¶é…ç½®](#-è¿›é˜¶é…ç½®)  
- [æ•…éšœæ’æŸ¥](#-æ•…éšœæ’æŸ¥)
- [è®¸å¯è¯](#-è®¸å¯è¯)

---

## ğŸ› ï¸ ç¡¬ä»¶è¦æ±‚
| ç»„ä»¶               | è§„æ ¼                  |
|--------------------|-----------------------|
| ESP32å¼€å‘æ¿        | å»ºè®®ä½¿ç”¨ESP32-S3      |
| USBæ•°æ®çº¿          | Type-Cæ¥å£            | 
| ç”µæº               | 5V/2Aé€‚é…å™¨           |
| ç½‘ç»œç¯å¢ƒ           | 2.4GHz WiFié¢‘æ®µ       |

---

## âš¡ å¿«é€Ÿéƒ¨ç½²

### 1. ç¯å¢ƒé…ç½®
1. å®‰è£…Arduino IDEï¼ˆâ‰¥2.0ï¼‰
2. æ·»åŠ å¼€å‘æ¿æ”¯æŒï¼š
   ```bash
   https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
   ```
3. å®‰è£…åº“ï¼š
   - ESPAsyncWebServer
   - WebSockets
   - Adafruit MQTT Library

### 2. è®¾å¤‡é…å¯¹
```cpp
// ä¿®æ”¹ç›®æ ‡è®¾å¤‡MACåœ°å€ï¼ˆä¸¤ä¸ªè®¾å¤‡éœ€äº’ç›¸é…ç½®ï¼‰
uint8_t peerAddress[] = {0xCC,0xBA,0x97,0x0F,0x2C,0x74}; 

// è®¾ç½®APçƒ­ç‚¹ï¼ˆä¸¤å°è®¾å¤‡ä¸åŒåç§°ï¼‰
WiFi.softAP("ESP32-Chat_1", "12345678");  // è®¾å¤‡1
WiFi.softAP("ESP32-Chat_2", "12345678");  // è®¾å¤‡2
```

### 3. çƒ§å½•ç¨‹åº
```bash
# ä½¿ç”¨PlatformIOå¿«é€Ÿç¼–è¯‘
pio run --target upload --environment esp32dev
```

---

## ğŸŒ ç³»ç»Ÿæ¶æ„
```mermaid
sequenceDiagram
    participant Web as ç½‘é¡µå®¢æˆ·ç«¯
    participant Server as ESP32 WebæœåŠ¡å™¨
    participant Peer as å¯¹ç«¯ESP32
    
    Web->>Server: WSè¿æ¥(ws://192.168.4.1)
    loop æ¶ˆæ¯å¾ªç¯
        Web->>Server: å‘é€æ¶ˆæ¯
        Server->>Peer: ESP-NOWä¼ è¾“
        Peer-->>Server: ACKç¡®è®¤
        Server->>Web: æ›´æ–°çŠ¶æ€(âˆš/Ã—)
    end
```

---

## ğŸ“‚ ä»£ç ç»“æ„
```
src/
â”œâ”€â”€ main.cpp                # ä¸»ç¨‹åºé€»è¾‘
â”œâ”€â”€ config.h                # è®¾å¤‡é…ç½®å‚æ•°
â”œâ”€â”€ websocket_handler.cpp   # WebSocketäº‹ä»¶å¤„ç†
â””â”€â”€ espnow_handler.cpp      # ESP-NOWé€šä¿¡æ ¸å¿ƒ
```

å…³é”®å‡½æ•°è¯´æ˜ï¼š
```cpp
void sendMessage(String msg) {
    // ç”Ÿæˆæ¶ˆæ¯ID â†’ å­˜å‚¨å¾…ç¡®è®¤åˆ—è¡¨ â†’ ESP-NOWå‘é€
}

void checkTimeouts() {
    // æ¯2ç§’æ£€æŸ¥æœªç¡®è®¤æ¶ˆæ¯ â†’ è‡ªåŠ¨é‡ä¼ ï¼ˆæœ€å¤š3æ¬¡ï¼‰
}
```

---

## ğŸ”§ è¿›é˜¶é…ç½®

### å¢åŠ ä¼ æ„Ÿå™¨æ•°æ®
```cpp
struct_message {
    ...
    float temperature;  // æ–°å¢æ¸©åº¦å­—æ®µ
    uint8_t humidity;   // æ–°å¢æ¹¿åº¦å­—æ®µ
};
```

### ä¿®æ”¹é‡ä¼ ç­–ç•¥
```cpp
// åœ¨checkTimeouts()ä¸­ä¿®æ”¹
if (currentTime - sendTime > 5000) {  // æ”¹ä¸º5ç§’è¶…æ—¶
    retryCount++;                     // æ·»åŠ é‡è¯•è®¡æ•°å™¨
    if(retryCount < 5) {...}         // é™åˆ¶æœ€å¤§é‡è¯•æ¬¡æ•°
}
```

---

## ğŸš¨ æ•…éšœæ’æŸ¥

| ç°è±¡                 | è§£å†³æ–¹æ¡ˆ                |
|----------------------|-------------------------|
| æ— æ³•å»ºç«‹WebSocketè¿æ¥ | æ£€æŸ¥é˜²ç«å¢™è®¾ç½®/ç«¯å£å ç”¨ |
| ACKç¡®è®¤è¶…æ—¶           | ç¡®è®¤MACåœ°å€é…ç½®æ­£ç¡®     |
| ç½‘é¡µæ˜¾ç¤ºæ–­è¿         | é‡æ–°è¿æ¥WiFiçƒ­ç‚¹       |
| æ•°æ®åŒ…ä¸¢å¤±           | ç¼©çŸ­è®¾å¤‡é—´è·ç¦»         |

---

## ğŸ“œ è®¸å¯è¯
**MIT License**  
å…è®¸å•†ä¸šç”¨é€”ï¼Œéœ€ä¿ç•™åŸå§‹ç‰ˆæƒå£°æ˜ã€‚å®Œæ•´è®¸å¯æ–‡æœ¬è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---
```

> é¡¹ç›®æ¼”ç¤ºè§†é¢‘ä¸è¯¦ç»†æ–‡æ¡£è¯·è®¿é—®ï¼šhttps://github.com/yourusername/esp32-espnow-websocket/wiki
